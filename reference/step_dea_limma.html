<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Step: Differential Expression Analysis (DEA) using Limma — step_dea_limma • glysmith</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Step: Differential Expression Analysis (DEA) using Limma — step_dea_limma"><meta name="description" content="Run differential analysis using linear model-based analysis via glystats::gly_limma(),
then filter the experiment to keep only the differentially expressed variables using glystats::filter_sig_vars().
By default, this runs DEA on the main experiment (exp), but can be configured
to run on derived traits (trait_exp) or other experiment objects.
This step is the recommended DEA method for all experiments,
for both two-group and multi-group experiments."><meta property="og:description" content="Run differential analysis using linear model-based analysis via glystats::gly_limma(),
then filter the experiment to keep only the differentially expressed variables using glystats::filter_sig_vars().
By default, this runs DEA on the main experiment (exp), but can be configured
to run on derived traits (trait_exp) or other experiment objects.
This step is the recommended DEA method for all experiments,
for both two-group and multi-group experiments."><meta property="og:image" content="https://glycoverse.github.io/glysmith/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">glysmith</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/glysmith.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/ai.html">AI-Powered Workflow in Glysmith</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Step: Differential Expression Analysis (DEA) using Limma</h1>

      <div class="d-none name"><code>step_dea_limma.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Run differential analysis using linear model-based analysis via <code><a href="https://glycoverse.github.io/glystats/reference/gly_limma.html" class="external-link">glystats::gly_limma()</a></code>,
then filter the experiment to keep only the differentially expressed variables using <code><a href="https://glycoverse.github.io/glystats/reference/filter_sig_vars.html" class="external-link">glystats::filter_sig_vars()</a></code>.
By default, this runs DEA on the main experiment (<code>exp</code>), but can be configured
to run on derived traits (<code>trait_exp</code>) or other experiment objects.
This step is the recommended DEA method for all experiments,
for both two-group and multi-group experiments.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">step_dea_limma</span><span class="op">(</span></span>
<span>  on <span class="op">=</span> <span class="st">"exp"</span>,</span>
<span>  p_adj_method <span class="op">=</span> <span class="st">"BH"</span>,</span>
<span>  covariate_cols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subject_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ref_group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  contrasts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  filter_p_adj_cutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  filter_p_val_cutoff <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  filter_fc_cutoff <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-on">on<a class="anchor" aria-label="anchor" href="#arg-on"></a></dt>
<dd><p>Name of the experiment data in <code>ctx$data</code> to run analysis on.
Default is <code>"exp"</code> for differential expression analysis.
Use <code>"trait_exp"</code> for differential trait analysis.
Use <code>"motif_exp"</code> for differential motif analysis.</p></dd>


<dt id="arg-p-adj-method">p_adj_method<a class="anchor" aria-label="anchor" href="#arg-p-adj-method"></a></dt>
<dd><p>A character string specifying the method for multiple testing correction.
Must be one of the methods supported by <code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">stats::p.adjust()</a></code>. Default is "BH" (Benjamini-Hochberg).
Set to NULL to skip p-value adjustment.</p></dd>


<dt id="arg-covariate-cols">covariate_cols<a class="anchor" aria-label="anchor" href="#arg-covariate-cols"></a></dt>
<dd><p>(Only for <code><a href="https://glycoverse.github.io/glystats/reference/gly_limma.html" class="external-link">gly_limma()</a></code>) A character vector specifying column names in sample information
to include as covariates in the limma model. Default is NULL.</p></dd>


<dt id="arg-subject-col">subject_col<a class="anchor" aria-label="anchor" href="#arg-subject-col"></a></dt>
<dd><p>(Only for <code><a href="https://glycoverse.github.io/glystats/reference/gly_limma.html" class="external-link">gly_limma()</a></code>) A character string specifying the column name in sample information
that contains subject identifiers for paired comparisons. Default is NULL.</p></dd>


<dt id="arg-ref-group">ref_group<a class="anchor" aria-label="anchor" href="#arg-ref-group"></a></dt>
<dd><p>A character string specifying the reference group.
If NULL (default), the first level of the group factor is used as the reference.
Only used for two-group comparisons.</p></dd>


<dt id="arg-contrasts">contrasts<a class="anchor" aria-label="anchor" href="#arg-contrasts"></a></dt>
<dd><p>A character vector specifying custom contrasts.
If NULL (default), all pairwise comparisons are automatically generated,
and the levels coming first in the factor will be used as the reference group.
Supports two formats: "group1-group2" or "group1_vs_group2".
Use the second format if group names contain hyphens.
"group1" will be used as the reference group.</p></dd>


<dt id="arg-filter-p-adj-cutoff">filter_p_adj_cutoff<a class="anchor" aria-label="anchor" href="#arg-filter-p-adj-cutoff"></a></dt>
<dd><p>Adjusted p-value cutoff for filtering.</p></dd>


<dt id="arg-filter-p-val-cutoff">filter_p_val_cutoff<a class="anchor" aria-label="anchor" href="#arg-filter-p-val-cutoff"></a></dt>
<dd><p>Raw p-value cutoff for filtering.</p></dd>


<dt id="arg-filter-fc-cutoff">filter_fc_cutoff<a class="anchor" aria-label="anchor" href="#arg-filter-fc-cutoff"></a></dt>
<dd><p>Fold change cutoff for filtering.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to <code><a href="https://rdrr.io/pkg/limma/man/lmFit.html" class="external-link">limma::lmFit()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>glysmith_step</code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Data required:</p><ul><li><p><code>exp</code> (if <code>on = "exp"</code>): The experiment to run DEA on</p></li>
<li><p><code>trait_exp</code> (if <code>on = "trait_exp"</code>): The trait experiment to run DEA on</p></li>
<li><p><code>motif_exp</code> (if <code>on = "motif_exp"</code>): The motif experiment to run DEA on</p></li>
</ul><p>Data generated:</p><ul><li><p><code>dea_res</code>: The DEA (differential expression analysis) results (if <code>on = "exp"</code>, default)</p></li>
<li><p><code>dta_res</code>: The DTA (differential trait analysis) results (if <code>on = "trait_exp"</code>)</p></li>
<li><p><code>dma_res</code>: The DMA (differential motif analysis) results (if <code>on = "motif_exp"</code>)</p></li>
<li><p><code>sig_exp</code>: The filtered experiment (if <code>on = "exp"</code>, default)</p></li>
<li><p><code>sig_trait_exp</code>: The filtered trait experiment (if <code>on = "trait_exp"</code>)</p></li>
<li><p><code>sig_motif_exp</code>: The filtered motif experiment (if <code>on = "motif_exp"</code>)</p></li>
</ul><p>Tables generated:</p><ul><li><p><code>dea</code>: A table containing the DEA (differential expression analysis) result (if <code>on = "exp"</code>, default)</p></li>
<li><p><code>dta</code>: A table containing the DTA (differential trait analysis) result (if <code>on = "trait_exp"</code>)</p></li>
<li><p><code>dma</code>: A table containing the DMA (differential motif analysis) result (if <code>on = "motif_exp"</code>)</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="ai-prompt">AI Prompt<a class="anchor" aria-label="anchor" href="#ai-prompt"></a></h2>


<p><em>This section is for AI in <code><a href="inquire_blueprint.html">inquire_blueprint()</a></code> only.</em></p><ul><li><p>Use this step to perform DEA by default, unless the user asks for other methods.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://glycoverse.github.io/glystats/reference/gly_limma.html" class="external-link">glystats::gly_limma()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">step_dea_limma</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> &lt;step <span style="color: #0000BB;">"step_dea_limma()"</span>&gt; <span style="font-style: italic;">Differential expression analysis (limma)</span></span>
<span class="r-in"><span><span class="fu">step_dea_limma</span><span class="op">(</span>on <span class="op">=</span> <span class="st">"trait_exp"</span><span class="op">)</span>  <span class="co"># Differential trait analysis</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> &lt;step <span style="color: #0000BB;">"step_dea_limma(on = \"trait_exp\")"</span>&gt; <span style="font-style: italic;">Differential trait analysis (limma)</span></span>
<span class="r-in"><span><span class="fu">step_dea_limma</span><span class="op">(</span>p_adj_method <span class="op">=</span> <span class="st">"BH"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> &lt;step <span style="color: #0000BB;">"step_dea_limma(p_adj_method = \"BH\")"</span>&gt; <span style="font-style: italic;">Differential expression analysis</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">(limma)</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bin Fu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

