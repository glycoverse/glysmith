% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/step-survival.R
\name{step_cox}
\alias{step_cox}
\title{Step: Cox Proportional Hazards Model}
\usage{
step_cox(
  on = "exp",
  time_col = "time",
  event_col = "event",
  p_adj_method = "BH",
  ...
)
}
\arguments{
\item{on}{Name of the experiment to run Cox regression on.
Can be "exp", "sig_exp", "trait_exp", "sig_trait_exp",
"dynamic_motif_exp", "sig_dynamic_motif_exp", "branch_motif_exp", "sig_branch_motif_exp".}

\item{time_col}{Column name in sample information containing survival time.
Default is "time".}

\item{event_col}{Column name in sample information containing event indicator
(1 for event, 0 for censoring). Default is "event".}

\item{p_adj_method}{Method for adjusting p-values. See \code{p.adjust.methods}.
Default is "BH". If NULL, no adjustment is performed.}

\item{...}{Additional arguments passed to \code{glystats::gly_cox()}.}
}
\value{
A \code{glysmith_step} object.
}
\description{
Perform survival analysis by fitting a Cox proportional hazards model
using \code{glystats::gly_cox()} for each variable.
This step identifies variables associated with survival outcomes.

This step depends on the \code{on} parameter (default: \code{exp}).
\itemize{
\item When \code{on = "exp"}, requires \code{exp} (usually after \code{\link[=step_preprocess]{step_preprocess()}}).
\item When \code{on = "sig_exp"}, requires \code{sig_exp} from one of \code{\link[=step_dea_limma]{step_dea_limma()}},
\code{\link[=step_dea_ttest]{step_dea_ttest()}}, \code{\link[=step_dea_wilcox]{step_dea_wilcox()}}, \code{\link[=step_dea_anova]{step_dea_anova()}}, or \code{\link[=step_dea_kruskal]{step_dea_kruskal()}}.
\item When \code{on = "trait_exp"}, requires \code{trait_exp} from \code{\link[=step_derive_traits]{step_derive_traits()}}.
\item When \code{on = "sig_trait_exp"}, requires \code{sig_trait_exp} from DEA on traits.
\item When \code{on = "dynamic_motif_exp"}, requires \code{dynamic_motif_exp} from \code{\link[=step_quantify_dynamic_motifs]{step_quantify_dynamic_motifs()}}.
\item When \code{on = "sig_dynamic_motif_exp"}, requires \code{sig_dynamic_motif_exp} from DEA on motifs.
\item When \code{on = "branch_motif_exp"}, requires \code{branch_motif_exp} from \code{\link[=step_quantify_branch_motifs]{step_quantify_branch_motifs()}}.
\item When \code{on = "sig_branch_motif_exp"}, requires \code{sig_branch_motif_exp} from DEA on motifs.
}
}
\details{
Data required:
\itemize{
\item \code{exp} (if \code{on = "exp"}): The experiment to run Cox regression on
\item \code{trait_exp} (if \code{on = "trait_exp"}): The trait experiment to run Cox regression on
\item \code{dynamic_motif_exp} (if \code{on = "dynamic_motif_exp"}): The dynamic motif experiment to run Cox regression on
\item \code{branch_motif_exp} (if \code{on = "branch_motif_exp"}): The branch motif experiment to run Cox regression on
}

The experiment must contain survival data with \code{time_col} and \code{event_col} columns
in the sample information.

Tables generated (with suffixes):
\itemize{
\item \code{cox}: A table containing Cox regression results with columns:
\itemize{
\item \code{variable}: Variable name
\item \code{coefficient}: Regression coefficient (log hazard ratio)
\item \code{std.error}: Standard error of the coefficient
\item \code{statistic}: Wald test statistic
\item \code{p_val}: Raw p-value from Wald test
\item \code{hr}: Hazard ratio (exp(coefficient))
\item \code{p_adj}: Adjusted p-value (if p_adj_method is not NULL)
}
}
}
\section{AI Prompt}{

\emph{This section is for AI in \code{\link[=inquire_blueprint]{inquire_blueprint()}} only.}
\itemize{
\item Include this step when users want to identify variables associated with survival outcomes.
\item This step requires survival data (time and event columns) in the sample information.
\item Always ask for the column names for survival data, unless explicitly provided.
}
}

\examples{
step_cox()
step_cox(time_col = "survival_time", event_col = "death")
step_cox(on = "sig_exp", p_adj_method = "bonferroni")
}
\seealso{
\code{\link[glystats:gly_cox]{glystats::gly_cox()}}, \code{\link[survival:coxph]{survival::coxph()}}
}
