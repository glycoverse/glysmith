% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/step-correlation.R
\name{step_correlation}
\alias{step_correlation}
\title{Step: Correlation Analysis}
\usage{
step_correlation(
  on = "exp",
  on_cor = c("variable", "sample"),
  method = c("pearson", "spearman"),
  p_adj_method = "BH",
  plot_width = 7,
  plot_height = 7,
  ...
)
}
\arguments{
\item{on}{Name of the experiment to run correlation analysis on.
Can be "exp", "sig_exp", "trait_exp", "sig_trait_exp",
"dynamic_motif_exp", "sig_dynamic_motif_exp", "branch_motif_exp", "sig_branch_motif_exp".}

\item{on_cor}{A character string specifying what to correlate.
Either "variable" (default) to correlate variables/features, or "sample" to correlate samples.}

\item{method}{A character string indicating which correlation coefficient is to be computed.
One of "pearson" (default) or "spearman".}

\item{p_adj_method}{A character string specifying the method to adjust p-values.
See \code{p.adjust.methods} for available methods. Default is "BH".
If NULL, no adjustment is performed.}

\item{plot_width}{Width of the plot in inches. Default is 7.}

\item{plot_height}{Height of the plot in inches. Default is 7.}

\item{...}{Additional arguments passed to \code{glystats::gly_cor()}.}
}
\value{
A \code{glysmith_step} object.
}
\description{
Perform pairwise correlation analysis using \code{glystats::gly_cor()} and
visualize the correlation matrix using \code{glyvis::plot_corrplot()}.
This step calculates correlation coefficients and p-values for all pairs
of variables or samples.
}
\details{
Data required:
\itemize{
\item \code{exp} (if \code{on = "exp"}): The experiment to run correlation analysis on
\item \code{trait_exp} (if \code{on = "trait_exp"}): The trait experiment to run correlation analysis on
\item \code{dynamic_motif_exp} (if \code{on = "dynamic_motif_exp"}): The dynamic motif experiment to run correlation analysis on
\item \code{branch_motif_exp} (if \code{on = "branch_motif_exp"}): The branch motif experiment to run correlation analysis on
}

Tables generated (with suffixes):
\itemize{
\item \code{correlation}: A table containing pairwise correlation results with columns:
\itemize{
\item \code{variable1}, \code{variable2} (or \code{sample1}, \code{sample2} if \code{on = "sample"})
\item \code{cor}: Correlation coefficient
\item \code{p_val}: P-value from correlation test
\item \code{p_adj}: Adjusted p-value (if p_adj_method is not NULL)
}
}

Plots generated (with suffixes):
\itemize{
\item \code{correlation}: A correlation matrix heatmap
}
}
\section{AI Prompt}{

\emph{This section is for AI in \code{\link[=inquire_blueprint]{inquire_blueprint()}} only.}
\itemize{
\item Include this step to explore relationships between variables or samples.
\item Be careful to use when sample size or variable number is large (> 50).
Before using this step for large data, ask the user if they want to proceed.
}
}

\examples{
step_correlation()
step_correlation(on = "sig_exp")
step_correlation(on_cor = "sample", method = "spearman")
}
\seealso{
\code{\link[glystats:gly_cor]{glystats::gly_cor()}}, \code{\link[glyvis:plot_corrplot]{glyvis::plot_corrplot()}}
}
