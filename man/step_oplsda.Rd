% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/step-dimension.R
\name{step_oplsda}
\alias{step_oplsda}
\title{Step: Orthogonal Partial Least Squares Discriminant Analysis (OPLS-DA)}
\usage{
step_oplsda(on = "exp", pred_i = 1, ortho_i = NA, scale = TRUE, ...)
}
\arguments{
\item{on}{Name of the experiment to run OPLS-DA on.
Can be "exp", "sig_exp", "trait_exp", "sig_trait_exp", "motif_exp", "sig_motif_exp".}

\item{pred_i}{Number of predictive components to include. Default is 1.}

\item{ortho_i}{Number of orthogonal components to include. Default is NA (automatic).}

\item{scale}{Logical indicating whether to scale the data. Default is TRUE.}

\item{...}{Additional arguments passed to \code{glystats::gly_oplsda()}.}
}
\value{
A \code{glysmith_step} object.
}
\description{
Perform OPLS-DA using \code{glystats::gly_oplsda()} and plot it with \code{glyvis::plot_oplsda()}.
OPLS-DA separates variation into predictive (related to group) and orthogonal (unrelated) components.
This step only works with binary classification (exactly 2 groups).
}
\details{
Data required:
\itemize{
\item \code{exp} (if \code{on = "exp"}): The experiment to run OPLS-DA on
\item \code{trait_exp} (if \code{on = "trait_exp"}): The trait experiment to run OPLS-DA on
\item \code{motif_exp} (if \code{on = "motif_exp"}): The motif experiment to run OPLS-DA on
}

Tables generated (with suffixes):
\itemize{
\item \code{oplsda_samples}: A table containing the OPLS-DA scores for each sample
\item \code{oplsda_variables}: A table containing the OPLS-DA loadings for each variable
\item \code{oplsda_variance}: A table containing the explained variance for each component
\item \code{oplsda_vip}: A table containing the Variable Importance in Projection (VIP) scores
\item \code{oplsda_perm_test}: A table containing permutation test results
}

Plots generated (with suffixes):
\itemize{
\item \code{oplsda_scores}: An OPLS-DA score plot colored by group
\item \code{oplsda_loadings}: An OPLS-DA loading plot
\item \code{oplsda_variance}: An OPLS-DA variance (scree) plot
\item \code{oplsda_vip}: An OPLS-DA VIP score plot
}
}
\section{AI Prompt}{

\emph{This section is for AI in \code{\link[=inquire_blueprint]{inquire_blueprint()}} only.}
\itemize{
\item Include this step when users want supervised dimensionality reduction for binary classification.
\item OPLS-DA is appropriate when you have exactly 2 groups and want to separate predictive from orthogonal variation.
\item Consider using this after a DEA step to focus on significant variables.
}
}

\examples{
step_oplsda()
step_oplsda(pred_i = 1, ortho_i = 1)
}
\seealso{
\code{\link[glystats:gly_oplsda]{glystats::gly_oplsda()}}, \code{\link[glyvis:plot_oplsda]{glyvis::plot_oplsda()}}
}
