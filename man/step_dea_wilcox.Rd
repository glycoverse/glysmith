% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/step-dea.R
\name{step_dea_wilcox}
\alias{step_dea_wilcox}
\title{Step: Differential Expression Analysis (DEA) using Wilcoxon test}
\usage{
step_dea_wilcox(
  on = "exp",
  p_adj_method = "BH",
  ref_group = NULL,
  filter_p_adj_cutoff = 0.05,
  filter_p_val_cutoff = NULL,
  filter_fc_cutoff = NULL,
  ...
)
}
\arguments{
\item{on}{Name of the experiment data in \code{ctx$data} to run analysis on.
Default is \code{"exp"} for differential expression analysis.
Use \code{"trait_exp"} for differential trait analysis.
Use \code{"dynamic_motif_exp"} for differential dynamic motif analysis.
Use \code{"branch_motif_exp"} for differential branch motif analysis.}

\item{p_adj_method}{A character string specifying the method to adjust p-values.
See \code{p.adjust.methods} for available methods. Default is "BH".
If NULL, no adjustment is performed.}

\item{ref_group}{A character string specifying the reference group.
If NULL (default), the first level of the group factor is used as the reference.}

\item{filter_p_adj_cutoff}{Adjusted p-value cutoff for filtering.}

\item{filter_p_val_cutoff}{Raw p-value cutoff for filtering.}

\item{filter_fc_cutoff}{Fold change cutoff for filtering.}

\item{...}{Additional arguments passed to \code{\link[glystats:gly_wilcox]{glystats::gly_wilcox()}}.}
}
\value{
A \code{glysmith_step} object.
}
\description{
Run differential analysis using Wilcoxon analysis via \code{glystats::gly_wilcox()},
then filter the experiment to keep only the differentially expressed variables using \code{glystats::filter_sig_vars()}.
By default, this runs DEA on the main experiment (\code{exp}), but can be configured
to run on derived traits (\code{trait_exp}) or other experiment objects.
Only use this method for experiments with 2 groups.

This step depends on the \code{on} parameter (default: \code{exp}).
\itemize{
\item When \code{on = "exp"}, requires \code{exp} (usually after \code{\link[=step_preprocess]{step_preprocess()}}).
\item When \code{on = "trait_exp"}, requires \code{trait_exp} from \code{\link[=step_derive_traits]{step_derive_traits()}}.
\item When \code{on = "dynamic_motif_exp"}, requires \code{dynamic_motif_exp} from \code{\link[=step_quantify_dynamic_motifs]{step_quantify_dynamic_motifs()}}.
\item When \code{on = "branch_motif_exp"}, requires \code{branch_motif_exp} from \code{\link[=step_quantify_branch_motifs]{step_quantify_branch_motifs()}}.
}
}
\details{
Data required:
\itemize{
\item Depends on \code{on} parameter (default: \code{exp})
}

Data generated:
\itemize{
\item \code{dea_res}: The DEA results (if \code{on = "exp"}, default)
\item \code{dta_res}: The DTA results (if \code{on = "trait_exp"})
\item \code{dynamic_dma_res}: The DMA results (if \code{on = "dynamic_motif_exp"})
\item \code{branch_dma_res}: The DMA results (if \code{on = "branch_motif_exp"})
\item \code{sig_exp}: The filtered experiment (if \code{on = "exp"}, default)
\item \code{sig_trait_exp}: The filtered trait experiment (if \code{on = "trait_exp"})
\item \code{sig_dynamic_motif_exp}: The filtered dynamic motif experiment (if \code{on = "dynamic_motif_exp"})
\item \code{sig_branch_motif_exp}: The filtered branch motif experiment (if \code{on = "branch_motif_exp"})
}

Tables generated:
\itemize{
\item \code{dea}: A table containing the DEA result (if \code{on = "exp"}, default)
\item \code{dta}: A table containing the DTA result (if \code{on = "trait_exp"})
\item \code{dynamic_dma}: A table containing the DMA result (if \code{on = "dynamic_motif_exp"})
\item \code{branch_dma}: A table containing the DMA result (if \code{on = "branch_motif_exp"})
}
}
\section{AI Prompt}{

\emph{This section is for AI in \code{\link[=inquire_blueprint]{inquire_blueprint()}} only.}
\itemize{
\item Include this step only if the user explicitly asks for Wilcoxon test.
\item If the experiment has more than 2 groups but the user wants a specific two-group
comparison, ask which two groups to compare and include
\code{step_subset_groups(groups = c("A", "B"))} before this step.
}
}

\examples{
step_dea_wilcox()
step_dea_wilcox(on = "trait_exp")  # Differential trait analysis
}
\seealso{
\code{\link[glystats:gly_wilcox]{glystats::gly_wilcox()}}
}
